<!-- Enlighter Metainfo
{
  "id": 186,
  "title": "mcp cli testing",
  "next_button_title": null
}
-->
<p>Now that we've explored the development mode and web-based Inspector, let's dive into more advanced testing methods and learn how to install MCP servers directly from repositories. This will help you test servers programmatically and use the vast ecosystem of existing MCP servers.</p>

<h5>Testing with MCP CLI</h5>

<p>While the MCP Inspector provides a great visual interface, sometimes you need to test your servers programmatically or as part of automated workflows. MCP servers communicate using JSON-RPC 2.0 protocol over standard input/output, which means we can test them directly from the command line.</p>

<p>Let's start by testing our Echo server using basic CLI commands:</p>

<callout type="chat">
Create a new terminal window and run these commands to test the echo server:

First, make sure you're in the project directory with the virtual environment activated

# List available tools
echo '{"jsonrpc":"2.0","method":"tools/list","id":1}' | python echo_server.py

</callout>

<p>You should see the echo_tool in the response. </p>

<p>The output might be hard to read. Let's use `jq` to format it nicely:</p>

<callout type="chat">
Install jq if it's not installed yet:
- macOS: brew install jq
- Ubuntu/Debian: sudo apt-get install jq
- Windows: Download from https://stedolan.github.io/jq/download/

Then run:
echo '{"jsonrpc":"2.0","method":"notifications/initialized"}\n{"jsonrpc":"2.0","method":"tools/list","id":1}' | python echo_server.py | jq
</callout>

<checkable-item title="Tools list command returns formatted JSON with echo_tool"></checkable-item>

<h5>Creating Test Scripts</h5>

<p>Let's create a comprehensive test script for our Echo server that tests all its capabilities:</p>

<callout type="chat">
Create a file named test_echo_mcp.sh with the context as specified below.

#!/bin/bash

echo "Testing Echo MCP Server"
echo "======================"

run_mcp_test() {
    local test_name="$1"
    local method="$2"
    local params="$3"
    local jq_filter="$4"
    
    echo -e "\n${test_name}:"
    
    # Create a temporary file for the session
    local tmpfile=$(mktemp)
    
    # Write initialization sequence and command to temp file
    echo '{"jsonrpc":"2.0","method":"notifications/initialized"}' > "$tmpfile"
    if [ -n "$params" ]; then
        echo "{\"jsonrpc\":\"2.0\",\"method\":\"$method\",\"id\":1,\"params\":$params}" >> "$tmpfile"
    else
        echo "{\"jsonrpc\":\"2.0\",\"method\":\"$method\",\"id\":1}" >> "$tmpfile"
    fi
    
    # Run the server with the commands and filter the result
    if python echo_server.py < "$tmpfile" | grep -v "WARNING" | tail -n 1 | jq "$jq_filter" 2>/dev/null; then
        echo PASS
        result=0
    else
        echo FAIL
        result=1
    fi
    
    # Clean up
    rm "$tmpfile"
    return $result
}

# Test 1: List tools
run_mcp_test "1. Listing available tools" "tools/list" "" ".result.tools[].name"

# Test 2: Call echo_tool
run_mcp_test "2. Calling echo_tool with message" "tools/call" '{"name":"echo_tool","arguments":{"message":"Hello from CLI test!"}}' ".result.content[0].text"

# Test 3: List resources
run_mcp_test "3. Listing available resources" "resources/list" "" ".result.resources"

# Test 4: Read a resource
run_mcp_test "4. Reading echo resource" "resources/read" '{"uri":"echo://testing-resources"}' ".result.contents[0].text"

echo -e "\nAll tests completed!"
</callout>

<p>Now run the test script:</p>

<checkable-item title="The file with the test scripts created successfully"></checkable-item>

<callout type="chat">
Run the test script and verify all tests pass:
./test_echo_mcp.sh
</callout>

<checkable-item title="Test script executes successfully"></checkable-item>
<checkable-item title="All four tests show expected outputs"></checkable-item>

<alert>
If any test fails, check the error messages and ensure your Echo server is running correctly. You can also use the MCP Inspector to debug issues visually.
</alert>
